<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Nikhil Exam Center - Math CBT</title>
  <style>
    body {
      font-family: Arial;
      display: flex;
      margin: 0;
      background: #f8f9fa;
    }
    .sidebar {
      width: 20%;
      background: #ffffff;
      padding: 10px;
      border-right: 1px solid #ccc;
      height: 100vh;
      overflow-y: auto;
      position: sticky;
      top: 0;
    }
    .sidebar h2 {
      text-align: center;
      font-size: 18px;
      margin-bottom: 10px;
      color: #333;
    }
    .sidebar button {
      width: 40px;
      height: 40px;
      margin: 5px;
      border: none;
      background: #eee;
      border-radius: 5px;
      cursor: pointer;
    }
    .sidebar button.active {
      background: green;
      color: white;
    }
    .sidebar button.current {
      border: 2px solid blue;
    }
    .content {
      flex: 1;
      padding: 20px;
    }
    .question-box {
      border: 1px solid #ccc;
      padding: 15px;
      border-radius: 10px;
      background: #fff;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }
    .options label {
      display: block;
      margin-bottom: 10px;
      cursor: pointer;
    }
    .nav-buttons {
      margin-top: 20px;
    }
    .nav-buttons button {
      padding: 10px 20px;
      margin-right: 10px;
      border-radius: 8px;
      cursor: pointer;
    }
    .score-box {
      font-size: 20px;
      font-weight: bold;
      margin-top: 20px;
      color: green;
    }
    .timer {
      text-align: right;
      font-size: 18px;
      font-weight: bold;
      color: red;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

<div class="sidebar" id="sidebar">
  <h2>üßÆ Nikhil Exam Center</h2>
  <div id="user-status"></div>
  <div id="login-buttons">
    <button onclick="signIn()">Sign In</button>
    <button onclick="signUp()">Sign Up</button>
  </div>
</div>

<div class="content">
  <div class="timer" id="timer">Time Left: 15:00</div>
  <div class="question-box">
    <div id="question">Please log in to start the exam.</div>
    <div class="options" id="options"></div>
    <div class="nav-buttons">
      <button onclick="prevQuestion()">‚¨ÖÔ∏è Previous</button>
      <button onclick="nextQuestion()">Next ‚û°Ô∏è</button>
      <button onclick="submitExam()">‚úÖ Submit</button>
    </div>
    <div class="score-box" id="score"></div>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyDgD17HehIZ3RXWy9B6RbYT2Bl4HTZZzfI",
  authDomain: "cloudstorage-bf72f.firebaseapp.com",
  databaseURL: "https://cloudstorage-bf72f-default-rtdb.firebaseio.com",
  projectId: "cloudstorage-bf72f",
  storageBucket: "cloudstorage-bf72f.firebasestorage.app",
  messagingSenderId: "240415341844",
  appId: "1:240415341844:web:e508a987cbbea4dcf01601",
  measurementId: "G-E49R91SPL9"
};

// Initialize Firebase
const app = firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const database = firebase.database();

// Exam logic
const questions = [];
let current = 0;
const answers = [];

function getRandomInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

function generateMathQuestions() {
  const types = ['add', 'sub', 'mul', 'div', 'square'];
  for (let i = 0; i < 100; i++) {
    const type = types[getRandomInt(0, types.length - 1)];
    let a = getRandomInt(1, 10); 
    let b = getRandomInt(1, 10); 
    let questionText, correct;

    switch (type) {
      case 'add':
        correct = a + b;
        questionText = `${a} + ${b} = ?`;
        break;
      case 'sub':
        correct = a - b;
        questionText = `${a} - ${b} = ?`;
        break;
      case 'mul':
        correct = a * b;
        questionText = `${a} √ó ${b} = ?`;
        break;
      case 'div':
        correct = Math.floor(a / b);
        questionText = `${a} √∑ ${b} = ?`;
        break;
      case 'square':
        correct = a * a;
        questionText = `What is ${a}¬≤ ?`;
        break;
    }

    const options = [];
    const correctIndex = getRandomInt(0, 3);
    for (let j = 0; j < 4; j++) {
      if (j === correctIndex) {
        options.push(correct);
      } else {
        let wrong = correct + getRandomInt(-5, 5);
        while (wrong === correct || options.includes(wrong)) {
          wrong = correct + getRandomInt(-5, 5);
        }
        options.push(wrong);
      }
    }

    questions.push({ q: questionText, options, correctIndex });
    answers.push(null);
  }
}

function loadQuestion(index) {
  const q = questions[index];
  document.getElementById("question").innerText = `Q${index + 1}: ${q.q}`;
  document.getElementById("options").innerHTML = q.options.map((opt, i) => `
    <label>
      <input type="radio" name="opt" value="${i}" ${answers[index] === i ? "checked" : ""} onchange="saveAnswer(${index}, ${i})"> ${opt}
    </label>
  `).join('');
}

function saveAnswer(qIndex, optIndex) {
  answers[qIndex] = optIndex;
}

function nextQuestion() {
  if (current < questions.length - 1) {
    current++;
    loadQuestion(current);
  }
}

function prevQuestion() {
  if (current > 0) {
    current--;
    loadQuestion(current);
  }
}

function submitExam() {
  let score = 0;
  questions.forEach((q, i) => {
    if (answers[i] === q.correctIndex) score++;
  });
  document.getElementById("score").innerText = `You scored: ${score}/100`;
}

function signIn() {
  const email = prompt("Enter your email:");
  const password = prompt("Enter your password:");

  auth.signInWithEmailAndPassword(email, password)
    .then((userCredential) => {
      loadExam();
    })
    .catch((error) => {
      alert("Error: " + error.message);
    });
}

function signUp() {
  const email = prompt("Enter your email:");
  const password = prompt("Enter your password:");

  auth.createUserWithEmailAndPassword(email, password)
    .then((userCredential) => {
      loadExam();
    })
    .catch((error) => {
      alert("Error: " + error.message);
    });
}

function loadExam() {
  document.getElementById("user-status").innerText = "You are logged in!";
  generateMathQuestions();
  loadQuestion(current);
}

</script>

</body>
  </html>
