<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Nikhil Exam Center - Math CBT</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      margin: 0;
      background: #f4f6f9;
    }
    .sidebar {
      width: 20%;
      background: #333;
      color: white;
      padding: 20px;
      height: 100vh;
      position: sticky;
      top: 0;
    }
    .sidebar h2 {
      font-size: 24px;
      text-align: center;
      margin-bottom: 20px;
      color: #f8f9fa;
    }
    .sidebar button {
      width: 45px;
      height: 45px;
      margin: 5px;
      border: none;
      background: #ccc;
      border-radius: 50%;
      cursor: pointer;
      font-size: 18px;
    }
    .sidebar button.active {
      background: #28a745;
      color: white;
    }
    .sidebar button.current {
      background: #007bff;
      border: 2px solid #0056b3;
    }
    .content {
      flex: 1;
      padding: 20px;
      max-width: 80%;
    }
    .question-box {
      border: 1px solid #ddd;
      padding: 20px;
      border-radius: 10px;
      background: #ffffff;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    .options label {
      display: block;
      margin-bottom: 10px;
      cursor: pointer;
    }
    .nav-buttons {
      margin-top: 20px;
    }
    .nav-buttons button {
      padding: 12px 24px;
      margin-right: 15px;
      border-radius: 8px;
      cursor: pointer;
      background-color: #28a745;
      color: white;
      font-size: 16px;
      border: none;
    }
    .score-box {
      font-size: 18px;
      font-weight: bold;
      margin-top: 30px;
      color: green;
    }
    .timer {
      text-align: right;
      font-size: 18px;
      font-weight: bold;
      color: red;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>

<div class="sidebar" id="sidebar">
  <h2>üßÆ Nikhil Exam Center</h2>
</div>

<div class="content">
  <div class="timer" id="timer">Time Left: 15:00</div>
  <div class="question-box">
    <div id="question">Loading question...</div>
    <div class="options" id="options"></div>
    <div class="nav-buttons">
      <button onclick="prevQuestion()">‚¨ÖÔ∏è Previous</button>
      <button onclick="nextQuestion()">Next ‚û°Ô∏è</button>
      <button onclick="submitExam()">‚úÖ Submit</button>
    </div>
    <div class="score-box" id="score"></div>
    <div id="error-message"></div> <!-- For displaying error messages after exam -->
  </div>
</div>

<script>
  const questions = [];
  const answers = [];
  const correctAnswers = [];
  let current = 0;

  function getRandomInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function generateMathQuestions() {
    const types = ['add', 'sub', 'mul', 'div', 'square'];
    for (let i = 0; i < 100; i++) {
      const type = types[getRandomInt(0, types.length - 1)];
      let a = getRandomInt(1, 10);  // Only integers between 1 and 10
      let b = getRandomInt(1, 10);  // Only integers between 1 and 10
      let questionText, correct;

      switch (type) {
        case 'add':
          correct = a + b;
          questionText = `${a} + ${b} = ?`;
          break;
        case 'sub':
          correct = a - b;
          questionText = `${a} - ${b} = ?`;
          break;
        case 'mul':
          correct = a * b;
          questionText = `${a} √ó ${b} = ?`;
          break;
        case 'div':
          correct = Math.floor(a / b); // Round off result for division
          questionText = `${a} √∑ ${b} = ? (Round off)`;
          break;
        case 'square':
          correct = a * a;
          questionText = `What is ${a}¬≤ ?`;
          break;
      }

      const options = [];
      const correctIndex = getRandomInt(0, 3);
      for (let j = 0; j < 4; j++) {
        if (j === correctIndex) {
          options.push(correct);
        } else {
          let wrong = correct + getRandomInt(-5, 5); // Adding wrong answers with slight deviation
          while (wrong === correct || options.includes(wrong)) {
            wrong = correct + getRandomInt(-5, 5);
          }
          options.push(wrong);
        }
      }

      questions.push({ q: questionText, options, correctIndex });
      correctAnswers.push(correct);  // Store correct answer for validation
      answers.push(null);  // Initialize with null, meaning no answer chosen yet
    }
  }

  function loadQuestion(index) {
    const q = questions[index];
    document.getElementById("question").innerText = `Q${index + 1}: ${q.q}`;
    document.getElementById("options").innerHTML = q.options.map((opt, i) => `
      <label>
        <input type="radio" name="opt" value="${i}" ${answers[index] === i ? "checked" : ""} onchange="saveAnswer(${index}, ${i})"> ${opt}
      </label>
    `).join('');
    updateSidebarButtons();
    scrollToCurrent();
  }

  function saveAnswer(qIndex, optIndex) {
    answers[qIndex] = optIndex;
    updateSidebarButtons();
  }

  function nextQuestion() {
    if (current < questions.length - 1) {
      current++;
      loadQuestion(current);
    }
  }

  function prevQuestion() {
    if (current > 0) {
      current--;
      loadQuestion(current);
    }
  }

  function goToQuestion(index) {
    current = index;
    loadQuestion(current);
  }

  function updateSidebarButtons() {
    const sidebar = document.getElementById("sidebar");
    sidebar.innerHTML = `<h2>üßÆ Nikhil Exam Center</h2>` + questions.map((_, i) => `
      <button onclick="goToQuestion(${i})" class="${answers[i] !== null ? 'active' : ''} ${i === current ? 'current' : ''}">${i + 1}</button>
    `).join('');
  }

  function scrollToCurrent() {
    const sidebar = document.getElementById("sidebar");
    const currentButton = sidebar.querySelector(".current");
    if (currentButton) {
      currentButton.scrollIntoView({ behavior: "smooth", block: "nearest" });
    }
  }

  function submitExam() {
    let score = 0;
    let wrongAnswers = [];
    questions.forEach((q, i) => {
      if (answers[i] === q.correctIndex) score++;
      else wrongAnswers.push(`Q${i + 1}`);
    });
    
    let message = "";
    if (score > 90) message = "üî• Excellent!";
    else if (score > 75) message = "üí™ Good Job!";
    else if (score > 50) message = "üôÇ Average!";
    else message = "üòê Thoda aur padho!";
    
    document.getElementById("score").innerText = `Aapke Number: ${score}/100 ${message}`;
    
    // Display incorrect answers
    if (wrongAnswers.length > 0) {
      document.getElementById("error-message").innerText = `Incorrect answers: ${wrongAnswers.join(', ')}`;
    }
  }

  // Timer
  let timeLeft = 15 * 60;  // 15 minutes in seconds
  const timerInterval = setInterval(() => {
    if (timeLeft <= 0) {
      clearInterval(timerInterval);
      submitExam();
    } else {
      timeLeft--;
      const mins = String(Math.floor(timeLeft / 60)).padStart(2, '0');
      const secs = String(timeLeft % 60).padStart(2, '0');
      document.getElementById("timer").innerText = `Time Left: ${mins}:${secs}`;
    }
  }, 1000);

  generateMathQuestions();
  loadQuestion(current);
</script>

</body>
  </html>
